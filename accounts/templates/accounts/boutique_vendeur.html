<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>{{ vendor.business_name }} - Boutique</title>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css">
<style>
    body { background: #f8f9fa; font-family: "Segoe UI", sans-serif; }
    .product-card { border: 1px solid #ddd; border-radius: 8px; padding: 15px; background: white; margin-bottom: 20px; transition: transform 0.2s; }
    .product-card:hover { transform: scale(1.03); }
    .badge { margin-right: 5px; }
    .promotion { background: #dc3545; }
    .product-price { font-weight: bold; font-size: 1.1em; }
    .btn-group { display: flex; gap: 5px; flex-direction: column; }
</style>
</head>
<body>
<div class="container mt-5">
    <h1 class="text-center mb-2">{{ vendor.business_name }}</h1>
    <p class="text-center text-muted">{{ vendor.description }}</p>

    <!-- Formulaire de recherche -->
    <form method="get" class="mb-4 text-center">
        <input type="text" name="q" placeholder="Rechercher un produit..." value="{{ query|default:'' }}" class="form-control d-inline-block" style="width: 300px;">
        <button type="submit" class="btn btn-primary">üîç Rechercher</button>
    </form>

    <div class="row">
        {% for product in products %}
        <div class="col-md-4">
            <div class="product-card">
                {% if product.image %}
                <img src="{{ product.image.url }}" class="img-fluid mb-2" alt="{{ product.name }}">
                {% endif %}
                <h5>{{ product.name }}</h5>
                <p class="product-price">
                    {% if product.promotion > 0 %}
                        <span class="text-muted text-decoration-line-through">{{ product.price }} ‚Ç¨</span>
                        <span class="text-danger">{{ product.price|floatformat:2|floatformat:2|add:'-'|add:product.promotion }} ‚Ç¨</span>
                        <span class="badge promotion">-{{ product.promotion }}%</span>
                    {% else %}
                        {{ product.price }} ‚Ç¨
                    {% endif %}
                </p>
                <p>
                    {% if product.category %}<span class="badge bg-info">{{ product.category.name }}</span>{% endif %}
                    {% for tag in product.get_tags_list %}<span class="badge bg-secondary">{{ tag }}</span>{% endfor %}
                </p>
                <div class="btn-group">
                    <a href="{{ product.get_absolute_url }}" class="btn btn-success">Voir le produit</a>
                    {% if user.is_authenticated and user.customer_profile %}
                        <a href="{% url 'add_to_cart' product.pk %}" class="btn btn-primary">Ajouter au panier</a>
                    {% endif %}
                </div>
            </div>
        </div>
        {% empty %}
        <p class="text-center">Aucun produit trouv√©.</p>
        {% endfor %}
    </div>
</div>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
